<div class="overlay" [@overlay]="overlay"></div>
<div class="personal-inner" [@profileSection]="profileSection" *ngIf="profileData">
  <div class="personal-header">
    <ul>
      <li>
        <div class="profile-pic"
          [ngClass]="{'red-border' :  profileData.followUp <= 0, 'orange-border' :  profileData.followUp  > 0 && profileData.followUp <= 7,
         'yellow-border' :  profileData.followUp  > 7 && profileData.followUp <= 14, 'green-border' :  profileData.followUp  > 14 , 'blue-border' :  profileData.followUp === null }"
          *ngIf="profileData">
          <img *ngIf="profileData.image" class="md-avatar line-view-arc rounded-circle" [src]="profileData.image" />
          <img *ngIf="!profileData.image" class="md-avatar line-view-arc rounded-circle"
            src="../../assets/images/avatar.svg" alt="Avatar" />
        </div>
      </li>
      <li>
        <div class="details-section" *ngIf="profileData">
          <h3 (click)="addScroll(); profileSection = !profileSection; overlay = !overlay"
            [routerLink]="['../view-contacts']" [queryParams]="{userId:profileData.id}">
            {{profileData.prefix}} {{profileData.first_name}} {{profileData.middle_name}} {{profileData.last_name}}</h3>
          <p>{{profileData.mobile}}</p>
          <p>{{profileData.email}}</p>
          <p>{{profileData.street}} {{profileData.street2}} {{profileData.city}}</p>
          <p>{{profileData.state}} {{profileData.country}} {{profileData.zip_code}}</p>
          <p>Rating: {{profileData.status_rating}}</p>
        </div>
      </li>
    </ul>
    <div class="close" (click)="addScroll(); profileSection = !profileSection; overlay = !overlay">
      <img src="../../../assets/images/close.svg" alt="close" />
    </div>
  </div>
  <div class="personal-body">
    <div id="accordion" class="accordion">

      <div class="personal-inner1">
        <div class="personal-header1">
          <ul>
            <li>
              <div class="social-images">
                <ul class="d-flex justify-content-between flex-wrap">
                  <li (click)="sendCallMessage()">
                    <div class="social-inner">
                      <img src="../../../assets/images/active-call.svg" class="default" alt="active call" />
                      <img src="../../../assets/images/active-call-white.svg" class="white" alt="active call" />
                    </div>
                    <p>Call</p>
                  </li>
                  <li>
                    <div (click)="file.click()" class="box social-inner" style=" position: relative;top: -2px;">
                      <input type="file" class="hidethis" accept=".csv" #file>
                      <img src="../../../assets/images/upload.svg" class="default">
                      <img src="../../../assets/images/upload-white.svg" class="white">
                    </div>
                    <p>Upload</p>
                  </li>
                  <li (click)="exportSelectedContact()">
                    <div class="social-inner">
                      <img src="../../../assets/images/download.svg" class="default" alt="active call" />
                      <img src="../../../assets/images/download-white.svg" class="white" alt="active call" />
                    </div>
                    <p>Download</p>
                  </li>
                  <li>
                    <div class="social-inner" (click)="assign()">
                      <img src="../../../assets/images/select-icons/assign-grey.svg" class="default"
                        alt="active call" />
                      <img src="../../../assets/images/select-icons/assign-white.svg" class="white" alt="active call" />
                    </div>
                    <p>Assign</p>
                  </li>
                  <li>
                    <div class="social-inner" (click)="print()">
                      <img src="../../../assets/images/print.svg" class="default" alt="active call" />
                      <img src="../../../assets/images/print-white.svg" class="white" alt="active call" />
                    </div>
                    <p>Print</p>
                  </li>
                  <li>
                    <div class="social-inner" (click)="openSettingSidebar(true)">
                      <img src="../../../assets/images/settings.svg" class="default" alt="active call" />
                      <img src="../../../assets/images/settings-white.svg" class="white" alt="active call" />
                    </div>
                    <p>Setting</p>
                  </li>
                  <li>
                    <div class="social-inner">
                      <img src="../../../assets/images/fax.svg" class="default" alt="active call" />
                      <img src="../../../assets/images/fax-white.svg" class="white" alt="active call" />
                    </div>
                    <p>Fax</p>
                  </li>
                </ul>
              </div>
            </li>
          </ul>
        </div>
      </div>
      <div cdkDropList (cdkDropListDropped)="drop($event)" class="card mb-0 ">
        <span cdkDrag *ngFor="let idx of listDragAccodiansPos" class="">
          <div *ngIf="idx === 0" class="w-100 own-display-block">
            <div class="card-header collapsed" data-toggle="collapse" href="#collapseOne">
              <img src="../../../assets/images/notification-bell.svg" alt="notification" />
              <h5 class="mb-0">
                Notifications & Best time to Call
              </h5>
            </div>
            <div id="collapseOne" class="card-body collapse">
              <div class="notifications">
                <p>Available for call between 12PM to 3PM</p>
                <span>Load Data </span>
              </div>
            </div>
          </div>
          <div *ngIf="idx === 1" class="w-100">
            <div class="card-header collapsed" data-toggle="collapse" href="#collapseTwo">
              <img src="../../../assets/images/feed.svg" alt="notification" />
              <h5 class="mb-0">
                Activity Feed
              </h5>
            </div>
            <div id="collapseTwo" class="card-body collapse">
              <div class="activity-feed">
                <ul>
                  <li (click)="showData = 'all'"><a [ngClass]="showData === 'all' ? 'active':''">All</a></li>
                  <li (click)="showData = 'notes'"><a [ngClass]="showData === 'notes' ? 'active':''">Notes</a></li>
                  <li (click)="showData = 'emails'"><a [ngClass]="showData === 'emails' ? 'active':''">Emails</a></li>
                  <li (click)="showData = 'Calls'"><a [ngClass]="showData === 'Calls' ? 'active':''">
                      Calls</a></li>
                  <li (click)="showData = 'text'"><a [ngClass]="showData === 'text' ? 'active':''">Text</a></li>
                  <li>Activity</li>
                </ul>
                <div class="activity-wrapper">
                  <div *ngIf="showData === 'all'" class="port-body">
                    <div class="row notify-item line-in" *ngFor="let comment of profileData.comment">
                      <div class="col-1">
                        <div>
                          <div class="notify-icon">
                            <span class="name-no">
                              {{comment.created.name.substring(0, 1).toUpperCase()}}
                            </span>
                          </div>
                          <div class="not-badge">
                            <img height="10px" src="../../../assets/images/sidebar/file.svg" alt="active call" />
                          </div>
                        </div>
                      </div>
                      <div class="col-11 notify-body">
                        <div class="item-title">
                          <div>
                            <label class="mr-2"><strong>{{comment.created.name}}</strong>
                              &nbsp;
                              {{comment.created_at | date:'MM/dd/yyyy'}} at
                              {{comment.created_at | date:'shortTime'}}</label>
                          </div>
                          <div>
                          </div>
                        </div>
                        <p class="noti-para">
                          {{comment.comment}}
                        </p>
                        <em class="pi pi-ellipsis-h three-dot"></em>
                      </div>
                    </div>
                    <small *ngIf="(profileData.comment?.length === 0) && (tasksList.length === 0)
                  && (callCount === 0)">
                      No Results Found
                    </small>
                  </div>

                  <div *ngIf="showData === 'notes'" class="port-body">
                    <div class="row notify-item line-in" *ngFor="let comment of profileData.comment">
                      <div class="col-1">
                        <div>
                          <div class="notify-icon">
                            <span class="name-no">M</span>
                          </div>
                          <div class="not-badge">
                            <img height="10px" src="../../../assets/images/sidebar/file.svg" alt="active call" />
                          </div>
                        </div>
                      </div>
                      <div class="col-11 notify-body">
                        <div class="item-title">
                          <div>
                            <label class="mr-2"><strong>{{comment.created.name}}</strong>
                              &nbsp;
                              {{comment.created_at | date:'MM/dd/yyyy'}} at
                              {{comment.created_at | date:'shortTime'}}</label>
                          </div>
                          <div>
                          </div>
                        </div>
                        <p class="noti-para">
                          {{comment.comment}}
                        </p>
                        <em class="pi pi-ellipsis-h three-dot"></em>
                      </div>
                    </div>
                    <small *ngIf="(profileData.comment?.length === 0)">
                      No Results Found
                    </small>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div *ngIf="idx === 2" class="w-100" style="display: inline-block;">
            <div class="card-header collapsed" data-toggle="collapse" href="#collapseThree">
              <img src="../../../assets/images/information.svg" alt="notification" />
              <h5 class="mb-0">
                More Information
              </h5>
            </div>
            <div id="collapseThree" class="collapse">
              <div class="card-body">
                <div class="more_information">
                  <span>Location Interest</span>
                  <p>
                    {{profileData.interested_address}}
                    {{profileData.interested_address2}}
                  </p>
                  <span>Budget</span>
                  <p>
                    ${{profileData.budget_min}} -
                    ${{profileData.budget_max}}
                  </p>
                  <span>Timeframe</span>
                  <p>
                    {{profileData.timeframe}}
                  </p>
                  <span>Criteria</span>
                  <p>
                    {{profileData.criteria}}
                  </p>

                </div>
              </div>
            </div>
          </div>
          <div *ngIf="idx === 3" class="w-100" style="display: inline-block;">
            <div class="card-header collapsed" data-toggle="collapse" href="#collapseFour">
              <img src="../../../assets/images/tag.svg" alt="notification" />
              <h5 class="mb-0" *ngIf="profileData">
                Tags ({{profileData?.tag?.length}})
              </h5>
            </div>
            <div id="collapseFour" class="collapse" *ngIf="profileData">
              <div class="card-body">
                <div class="group-section">
                  <ul>
                    <li *ngFor="let tag of profileData.tag" class="pt-2">
                      <div class="group-text-wrapper">
                        <p>{{tag.tag}}</p>
                        <img (click)="removeTag(tag)" src="../../../assets/images/close.svg" alt="close"
                          (click)="removeTag(tag)" />
                      </div>
                    </li>
                  </ul>
                  <button class="add-group d-flex" type="button" (click)="assignTag()">Add tag</button>
                </div>
              </div>
            </div>
          </div>
          <div *ngIf="idx === 4" class="w-100" style="display: inline-block;">
            <div *ngIf="profileData !== undefined" class="card-header collapsed" data-toggle="collapse"
              href="#collapseFive">
              <img src="../../../assets/images/group.svg" alt="notification" />
              <h5 class="mb-0">
                Groups ({{profileData.group.length}})
              </h5>
            </div>
            <div *ngIf="profileData !== undefined" id="collapseFive" class="collapse">
              <div class="card-body">
                <div class="group-section">
                  <ul *ngIf="profileData">
                    <li *ngFor="let data of profileData.group; let i = index">
                      <div class="group-text-wrapper">
                        <p>{{data.group}}</p>
                        <img (click)="unAssignGroup(i)" src="../../../assets/images/close.svg" alt="close" />
                      </div>
                  </ul>
                  <button class="add-group" type="button" (click)="assignGroup()">+ Assign Group</button>
                </div>
              </div>
            </div>
          </div>
          <div *ngIf="idx === 5" class="w-100" style="display: inline-block;">
            <div class="card-header collapsed" data-toggle="collapse" href="#collapseSix">
              <img src="../../../assets/images/connection.svg" alt="notification" />
              <h5 class="mb-0">
                Connections ({{profileData.connections.length}})
              </h5>
            </div>
            <div id="collapseSix" class="collapse">
              <div class="card-body">
                <div class="connection">
                  <ul>
                    <li *ngFor="let connection of profileData.connections; let i = index">
                      <div class="connection-wrapper">
                        <span class="badge" *ngIf="connection.contact">{{connection.contact.split(" ")[1][0]}}</span>
                        <span class="name">{{connection.contact}} <span
                            class="partner">({{connection.relation_type}})</span> </span>
                        <span class="edit-wrapper-icon">
                          <img pTooltip="Edit" tooltipPosition="top" src="../../../assets/images/edit.svg" alt="edit"
                            class="pr-3 edit-icon" (click)="editConnection(i)" />
                          <img pTooltip="Delete" tooltipPosition="top" src="../../../assets/images/delete.svg"
                            class="delete-icon" alt="delete" (click)="deleteConnection(i, connection.id)" />
                        </span>
                      </div>
                    </li>
                  </ul>
                  <button class="add-group" type="button" (click)="addConnections()">+ Connection</button>
                </div>
              </div>
            </div>
          </div>
          <div *ngIf="idx === 6" class="w-100" style="display: inline-block;">
            <div class="card-header collapsed" data-toggle="collapse" href="#collapseSeven">
              <img src="../../../assets/images/social-media.svg" alt="notification" />
              <h5 class="mb-0">
                Social Media ({{profileData.social_media_links.length}})
              </h5>
            </div>
            <div id="collapseSeven" class="collapse">
              <div class="card-body">
                <div class="social-icon">
                  <ul class="social-media-list social-icons-custom">
                    <li *ngFor="let media of profileData.social_media_links" class="pos-rel">
                      <a [href]="media.link" target="_blank" class="social-media-links">
                        <span class="tooltiptext">{{media.link}}</span>
                        <span class="social-media-wrapper" *ngIf="media.link_type === 'Facebook'">
                          <img src="../../../assets/images/social media/facebook.svg" alt="facebook"
                            class="mr-3 social-media"></span>
                        <span class="social-media-wrapper" *ngIf="media.link_type === 'LinkedIn'"> <img
                            src="../../../assets/images/social media/linkedin.svg" alt="linkedin"
                            class="mr-3 social-media"></span>
                        <span class="social-media-wrapper" *ngIf="media.link_type === 'Twitter'"> <img
                            src="../../../assets/images/social media/twitter.svg" alt="twitter"
                            class="mr-3 social-media"></span>
                        <span class="social-media-wrapper" *ngIf="media.link_type === 'Instagram'"> <img
                            src="../../../assets/images/social media/instagram.svg" alt="instagram"
                            class="mr-3 social-media" /></span>
                        <span class="social-media-wrapper" *ngIf="media.link_type === 'Google+'"> <img
                            src="../../../assets/images/social media/google-plus.svg" alt="google-plus"
                            class="mr-3 social-media" /></span>
                        <span class="social-media-wrapper" *ngIf="media.link_type === 'Pinterest'"> <img
                            src="../../../assets/images/social media/pinterest.svg" alt="Pinterest"
                            class="mr-3 social-media" /></span>
                        <span class="social-media-wrapper" *ngIf="media.link_type === 'Blog'"> <img
                            src="../../../assets/images/social media/blogger.svg" alt="Blog"
                            class="mr-3 social-media" /></span>
                        <span class="social-media-wrapper" *ngIf="media.link_type === 'Wordpress'"> <img
                            src="../../../assets/images/social media/wordpress.svg" alt="Wordpress"
                            class="mr-3 social-media" /></span>
                        <span class="social-media-wrapper" *ngIf="media.link_type === 'Youtube'"> <img
                            src="../../../assets/images/social media/youtube.svg" alt="Youtube"
                            class="mr-3 social-media" /></span>
                        <span class="social-media-wrapper" *ngIf="media.link_type === 'Skype'"> <img
                            src="../../../assets/images/social media/skype.svg" alt="Skype"
                            class="mr-3 social-media" /></span>
                        <span class="social-media-wrapper" *ngIf="media.link_type === 'Other'"> <img
                            src="../../../assets/images/facebook.svg" alt="" class="mr-3 social-media"></span>
                      </a>
                    </li>
                  </ul>

                  <button class="add-group" type="button" (click)="addSocialMediaLink = true">+ Add link</button>
                </div>
              </div>
            </div>
          </div>
          <div *ngIf="idx === 7" class="w-100" style="display: inline-block;">
            <div class="card-header collapsed" data-toggle="collapse" href="#collapseEight">
              <img src="../../../assets/images/attachment.svg" alt="notification" />
              <h5 class="mb-0">
                Attachments ({{filesList.length}})
              </h5>
            </div>
            <div id="collapseEight" class="collapse">
              <div class="card-body">
                <div class="list-inline" *ngFor="let file of filesList; let i = index">
                  <div class="purchase-wrapper img_warper">
                    <img *ngIf="file.file_type === 'image/png'"
                      src="../../../assets/images/attachments/attachment-image.svg" alt="attachment">
                    <img *ngIf="file.file_type === 'image/jpeg'"
                      src="../../../assets/images/attachments/attachment-image.svg" alt="attachment">
                    <img *ngIf="file.file_type === 'application/pdf'"
                      src="../../../assets/images/attachments/attachment-file-pdf.svg" alt="attachment">
                    <img *ngIf="file.file_type === 'application/vnd.ms-excel'"
                      src="../../../assets/images/attachments/attachment-Excel_logo.svg" alt="attachment">
                    <img *ngIf="file.file_type === 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'"
                      src="../../../assets/images/attachments/attachment-Excel_logo.svg" alt="attachment">
                    <img
                      *ngIf="file.file_type === 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'"
                      src="../../../assets/images/attachments/attachment-document-file-docx.svg" alt="attachment">
                    <img *ngIf="file.file_type === 'application/msword'"
                      src="../../../assets/images/attachments/attachment-document-file-docx.svg" alt="attachment">
                    <span (click)="openModal(template)" *ngIf="file.filename?.length<=46"
                      class="inner-data pl-0 mr-7">{{file.filename?.substring(file.filename.indexOf("-") + 1)}}.{{file.file_type.substring(file.file_type.indexOf("/") + 1)}}</span>
                    <span *ngIf="file.filename?.length>46"
                      class="extension-data">{{file.filename.substring(file.filename.lastIndexOf("."))}}.{{file.file_type.substring(file.file_type.indexOf("/") + 1)}}</span>
                  </div>
                  <ng-template #template>

                    <div class="light-box">
                      <div class="arrow-section">
                        <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
                          <span aria-hidden="true">&times;</span>
                        </button>
                        <img [src]="file.file_url" alt="attachment" class="image-sec propImagesTab" />

                      </div>
                    </div>
                  </ng-template>
                  <div class="download-wrapper">
                    <a pTooltip="Download" tooltipPosition="top" target="_blank" rel="noopener noreferrer"
                      [href]="file.url">
                      <img src="../../../assets/images/download.svg" alt="download" class="download-icon">
                    </a>
                    <img pTooltip="Delete" tooltipPosition="top" src="../../../assets/images/delete.svg" alt=""
                      (click)="deleteFile(file.id, i)" class="delete-icon">
                  </div>
                </div>

                <div class="custom-file-upload attachment-upload pt-10">
                  <a class="load-data load-attached-data">+ Add File</a>
                  <input type="file" class="add-file" name="file" (change)="onFileSelect($event)"
                    accept="image/png, image/jpg, image/jpeg, .pdf, .doc, .docx, .xls, .xlsx" #fileUpload>
                </div>

              </div>

            </div>
          </div>
          <div *ngIf="idx === 13" class="w-100" style="display: inline-block;">
            <div class="card-header collapsed" data-toggle="collapse" href="#collapseForteen">
              <img src="../../../assets/images/program.svg" alt="notification" />
              <h5 class="mb-0">
                Tickets ({{ticketList.length}})
              </h5>
            </div>
            <div id="collapseForteen" class="collapse">
              <div class="card-body">
                <div *ngFor="let ticket of ticketList; let i = index" class="ticket-section-container">
                  <p class="ticket-name verLine">
                    {{ticket.subject}}
                    <span class="edit-icons">
                      <img pTooltip="Edit" tooltipPosition="top" src="../../../assets/images/edit.svg" alt="edit"
                        class="edit" style="cursor:pointer">
                    </span></p>
                  <p class="open-hours">Description: {{ticket.description}}</p>
                  <p class="open-hours">Opened:
                    {{ticket.created_at | date:'M/d/yyyy'}}
                    {{ticket.created_at | date:'shortTime'}}
                  </p>
                  <div class="single-line-dropdown-text">
                    <label>Type : <span class="date-time">
                        {{ticket.type}}</span></label>
                  </div>
                  <div class="single-line-dropdown-text">
                    <label>Status : <span class="date-time">
                        {{ticket.status}}</span></label>
                  </div>
                  <p class="grey-text">Owner : <span class="circle-gray">
                      {{ticket.assigne_details.assignee_name[0]}}
                    </span><span class="name-of-person">
                      {{ticket.assigne_details.assignee_name}}
                    </span>
                  </p>
                </div>
                <div class="mt-4 add-tick-btn">
                  <a class="load-data" (click)="updateModalState(true)"> + Add
                    Ticket</a>
                </div>
              </div>
            </div>
          </div>
          <div *ngIf="idx === 8" class="w-100" style="display: inline-block;">
            <div class="card-header collapsed" data-toggle="collapse" href="#collapseTen">
              <img class="task-image" src="../../../assets/images/sidebar/footer-task.svg" alt="notification" />
              <h5 class="mb-0">
                Tasks ({{tasksList.length}})
              </h5>
            </div>
            <div id="collapseTen" class="collapse">
              <div class="card-body">
                <div class="task-section-container" *ngFor="let task of tasksList; let i = index"
                  [ngClass]="{'high-priority': task.priority === 'High', 'medium-priority': task.priority === 'Medium', 'low-priority': task.priority === 'Low', 'none-priority': task.priority === 'none'}">
                  <ul>
                    <li><label class="task-heading">{{task.subject}}</label></li>
                    <li> <span [ngClass]="task.status === 'Over Due' ? 'over-due' : 'other-status'"
                        class="overdue">{{task.status}}</span></li>
                    <li (click)="editTask(i)">
                      <img pTooltip="Edit" tooltipPosition="top" src="../../../assets/images/edit.svg" alt="edit"
                        class="edit-alignment edit-icon">
                    </li>
                  </ul>
                  <h6>
                    <span class="circle-gray">{{task.assigne_details.assigne_name[0]}}</span>
                    <span class="name-of-person">{{task.assigne_details.assigne_name}}</span>
                  </h6>
                  <div class="single-line-dropdown-text">
                    <label>Due : <span class="date-time">{{task.due_date | date:'MM/dd/yyyy'}} at
                        {{task.due_time}}
                      </span></label>
                  </div>
                </div>
                <div class="btn-add-task">
                  <a class="load-data load-tasks-data" (click)="openAddPopUp()"> + Add Task</a>
                </div>
              </div>
            </div>
          </div>
          <div *ngIf="idx === 9" class="w-100" style="display: inline-block;">
            <div class="card-header collapsed" data-toggle="collapse" href="#collapseEleven">
              <img src="../../../assets/images/playbook.svg" alt="notification" />
              <h5 class="mb-0">
                Playbook ({{profileData?.associatedPlaybook.length}})
              </h5>
            </div>
            <div id="collapseEleven" class="collapse">
              <div class="card-body">
                <div class="playbook-wrapper"
                  *ngFor="let item of profileData?.associatedPlaybook; let idx_play = index">
                  <div class="row">
                    <div class="col-md-10 playbook-content">
                      <span>
                        <div class="d-inline-flex align-items-center playDropdown grey-text-play">
                          <span class="name-of-person">
                            {{item.title}}
                          </span>
                        </div>
                      </span>
                    </div>
                    <div class="col-md-2 text-right playbook-content playbook-edit">
                      <img pTooltip="Edit" tooltipPosition="top"
                        (click)="updateFilledPlaybook(item.id, item.playbook_form, item.title, idx_play)"
                        src="../../../assets/images/edit.svg" alt="edit" />
                      <img src="../../../assets/images/delete.svg" pTooltip="Delete" tooltipPosition="top" alt=""
                        (click)="deleteContactPlaybook(item.id)" class="delete-icon">
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-md-6 playbook-content grey-text-play">Owner:
                      <span class="playDropdown">
                        <span class="circle-gray" *ngIf="!item.image_url">
                          {{item.data_filled_by.split(" ")[0].substring(0, 1).toUpperCase()}}
                          {{(item.data_filled_by.split(" ").length >= 3) ? 
                                  item.data_filled_by.split(" ")[2].substring(0, 1).toUpperCase() :
                                  item.data_filled_by.split(" ")[1].substring(0, 1).toUpperCase()}}
                        </span>
                        <img class="circle-gray" [src]="item.image_url" *ngIf="item.image_url" alt="">
                        <span class="name-of-person setNamePos">
                          {{item.data_filled_by}}
                        </span>
                      </span>
                    </div>
                    <div class="col-md-6 playbook-content grey-text-play">
                      Updated:
                      <span class="playDropdown">
                        <span class="name-of-person">
                          {{item.updated_at | date:'MM/dd/yyyy'}}
                        </span>
                      </span>
                    </div>
                  </div>
                </div>
                <div class="mt-4 add-playbook-drpdwn">
                  <a class="load-data" (click)="assignPlaybook()"> + Add Playbook</a>
                </div>
              </div>
            </div>
          </div>
          <div *ngIf="idx === 11" class="w-100" style="display: inline-block;">
            <div class="card-header collapsed" data-toggle="collapse" href="#collapseTwelve">
              <img src="../../../assets/images/program.svg" alt="notification" />
              <h5 class="mb-0">
                Current Programs (1)
              </h5>
            </div>
            <div id="collapseTwelve" class="collapse">
              <div class="card-body">Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry
                richardson ad squid. 3 wolf moon officia aute, non cupidatat skateboard dolor brunch. Food
                truck quinoa nesciunt laborum eiusmod. Brunch 3 wolf moon tempor,
                sunt aliqua put a bird on it squid single-origin coffee nulla assumenda shoreditch et. samus
                labore sustainable VHS. </div>
            </div>
          </div>

          <div *ngIf="idx === 12" class="w-100" style="display: inline-block;">
            <div class="card-header collapsed" data-toggle="collapse" href="#collapseThirteen">
              <img src="../../../assets/images/program.svg" alt="notification" />
              <h5 class="mb-0">
                Transaction ({{profileData?.transaction.length}})
              </h5>
            </div>
            <div id="collapseThirteen" class="collapse">
              <div class="card-body">
                <div class="playbook-wrapper" *ngFor="let item of profileData?.transaction; let idx_play = index">
                  <div class="row">
                    <div class="col-md-10 playbook-content">
                      <span>
                        <div class="d-inline-flex align-items-center playDropdown grey-text-play">
                          <span class="name-of-person">
                            {{item.transaction_id}}
                          </span>
                        </div>
                      </span>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-md-6 playbook-content grey-text-play">
                      Status:
                      <span class="playDropdown">
                        <span class="name-of-person">
                          {{item.save_status}}
                        </span>
                      </span>
                    </div>
                    <div class="col-md-6 playbook-content grey-text-play">
                      Closing Date:
                      <span class="playDropdown">
                        <span class="name-of-person">
                          {{item.estimated_closing_leased_date | date:'MM/dd/yyyy'}}
                        </span>
                      </span>
                    </div>
                    <div class="col-md-6 playbook-content grey-text-play">
                      Transaction Type:
                      <span class="playDropdown">
                        <span class="name-of-person">
                          {{item.transaction_type}}
                        </span>
                      </span>
                    </div>
                    <div *ngIf="item.mls_id" class="col-md-6 playbook-content grey-text-play">
                      MLS ID:
                      <span class="playDropdown">
                        <span class="name-of-person">
                          {{item.mls_id}}
                        </span>
                      </span>
                    </div>
                    <div *ngIf="item.listing_key" class="col-md-6 playbook-content grey-text-play">
                      Listing Key:
                      <span class="playDropdown">
                        <span class="name-of-person">
                          {{item.listing_key}}
                        </span>
                      </span>
                    </div>
                    <div class="col-md-6 playbook-content grey-text-play">Created by:
                      <span class="playDropdown">
                        <span class="circle-gray" *ngIf="!item.image_url">
                          {{item.created_by.name.split(" ")[0].substring(0, 1).toUpperCase()}}
                          {{(item.created_by.name.split(" ").length >= 3) ? 
                          item.created_by.name.split(" ")[2].substring(0, 1).toUpperCase() :
                          item.created_by.name.split(" ")[1].substring(0, 1).toUpperCase()}}
                        </span>
                        <img class="circle-gray" [src]="item.image_url" *ngIf="item.image_url" alt="">
                        <span class="name-of-person setNamePos">
                          {{item.created_by.name}}
                        </span>
                      </span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </span>
      </div>

      <p-dialog position="center" [draggable]="false" [visible]="assignTagPopup"
        class="custom-popup popup-element add-contact add-contact-wrapper" [modal]="true">
        <p-header>Assign Tag
          <span class="close-pop" (click)="assignTagPopup = false; tagsData = []"><img src="assets/images/close.svg"
              alt="close" /></span>
        </p-header>
        <form>
          <div class="col-12 pt-3 pl-0 pr-0">
            <div class="vaildation-area dropdown-top">
              <tag-input name="tagInput" [(ngModel)]="tagsData" [onlyFromAutocomplete]="false"
                (onAdd)="onTagAdd($event)" (onRemove)="onTagRemove($event)" [separatorKeyCodes]="[188]"
                [placeholder]="'Tag'" [secondaryPlaceholder]="'Tag'">
                <tag-input-dropdown [showDropdownIfEmpty]="true" [focusFirstElement]="true" [displayBy]="'value'"
                  [identifyBy]="'id'" [autocompleteItems]="tags">
                  <ng-template let-item="item" let-index="index">
                    {{ item.value }}
                  </ng-template>
                </tag-input-dropdown>
              </tag-input>
            </div>
          </div>
        </form>

        <p-footer class="btns">
          <ion-button class="btn-save" (click)="updateTags()" [disabled]="tagsData.length === 0">Save</ion-button>
          <ion-button class="btn-cancel" (click)="assignTagPopup = false; tagsData = []">Cancel</ion-button>
        </p-footer>
      </p-dialog>

      <p-dialog class="new-tag-popup add-new-tag" position="center" [draggable]="false" [(visible)]="newTag"
        *ngIf="newTag">
        <div class="content new-tag-popup">
          <div class="close-btn-signup">
            <h5>Would you like to add this tag?</h5>
          </div>
        </div>
        <p-footer class="btns">
          <ion-button class="btn-cancel" (click)="newTag = false">No</ion-button>
          <ion-button class="btn-save" (click)="addTagToList()">Yes</ion-button>
        </p-footer>
      </p-dialog>

      <p-dialog position="center" [draggable]="false" [visible]="assignGroupPopup"
        class="popup-element custom-popup add-contact add-contact-wrapper" [modal]="true">
        <p-header>Assign Group
          <span class="close-pop" (click)="assignGroupPopup = false;  group = ''"><img src="assets/images/close.svg"
              alt="close" /></span>
        </p-header>
        <div class="col-12 pt-3 pl-0 pr-0">
          <div class="multi">
            <p-multiSelect panelStyleClass="panelSideCon" [options]="groupsData" appendTo="body" [(ngModel)]="group"
              class="multiple-select">
            </p-multiSelect>
          </div>
        </div>
        <p-footer class="btns">
          <ion-button class="btn-save" (click)="updateGroup()" [disabled]="group === ''">Save</ion-button>
          <ion-button class="btn-cancel" (click)="assignGroupPopup = false; group = ''">Cancel</ion-button>
        </p-footer>
      </p-dialog>

      <p-dialog position="center" [draggable]="false" [visible]="assignPlaybookPopup"
        class="popup-element custom-popup add-contact add-contact-wrapper" [modal]="true">
        <p-header>Add Playbook
          <span class="close-pop" (click)="assignPlaybookPopup = false"><img src="assets/images/close.svg"
              alt="close" /></span>
        </p-header>
        <div class="col-12 pt-3 pl-0 pr-0">
          <div class="vaildation-area dropdown-top add-plybook-drpdwn own-playbok">
            <p-dropdown class="select-dropdown" [(ngModel)]="selectedPlaybookID" [options]="playbookFormsList"
              placeholder="Playbook" appendTo="body">
            </p-dropdown>
          </div>
        </div>
        <p-footer class="btns">
          <ion-button (click)="openPlaybookFormPopup()" [disabled]="selectedPlaybookID === 0" class="btn-save">Save
          </ion-button>
          <ion-button class="btn-cancel" (click)="assignPlaybookPopup = false">Cancel</ion-button>
        </p-footer>
      </p-dialog>


      <p-dialog position="center" [draggable]="false" [visible]="PlaybookFormPopup"
        class="popup-element custom-popup add-playbook add-play-pop" [modal]="true">
        <p-header>
          {{model?.form_name}}
          <span class="close-pop" (click)="PlaybookFormPopup = false"><img src="assets/images/close.svg"
              alt="close" /></span>
        </p-header>
        <form>
          <div class="col-12 pt-3 pl-0 pr-0" style="padding-top: 0px !important;">
            <div class="vaildation-area dropdown-top">
              <div class="row">
                <div class="col-md-6" *ngFor="let item of model?.attributes;let i= index;">
                  <div class="form-group">
                    <div *ngIf="item.type=='text'">
                      <label class="private-form__label">{{item.label}}</label> <label *ngIf="item.required"
                        class="text-danger">*</label>
                      <small id="UIFormControl-632-help" tabindex="-1"
                        class="private-microcopy private-form__inlinehelp is--text--help">
                        {{item.description}}
                      </small>
                      <input type="text" (change)="updateValue(i, $event, item.type)" class="form-control"
                        [attr.value]="item.controlValue" id="{{item.name}}" placeholder="{{item.placeholder}}">
                      <p class="vaiidate-field" *ngIf="item.showError">
                        Required field cannot be blank
                      </p>
                    </div>
                    <div *ngIf="item.type=='email'">
                      <label class="private-form__label">{{item.label}}</label> <label *ngIf="item.required"
                        class="text-danger">*</label>
                      <small id="UIFormControl-632-help" tabindex="-1"
                        class="private-microcopy private-form__inlinehelp is--text--help">
                        {{item.description}}
                      </small>
                      <input type="email" (change)="updateValue(i, $event, item.type)" class="form-control"
                        id="{{item.name}}" [attr.value]="item.controlValue" placeholder="{{item.placeholder}}">
                      <p class="vaiidate-field" *ngIf="item.showError">
                        Required field cannot be blank
                      </p>
                    </div>
                    <div *ngIf="item.type=='phone'" class="customPlaybookPhone phone-play-book">
                      <label class="private-form__label">{{item.label}}</label> <label *ngIf="item.required"
                        class="text-danger">*</label>
                      <small id="UIFormControl-632-help" tabindex="-1"
                        class="private-microcopy private-form__inlinehelp is--text--help">
                        {{item.description}}
                      </small>
                      <ngx-intl-tel-input [cssClass]="'country-input own-country-code'"
                        [preferredCountries]="preferredCountries" [enableAutoCountrySelect]="true"
                        [enablePlaceholder]="true" [searchCountryFlag]="true"
                        [searchCountryField]="[SearchCountryField.Iso2, SearchCountryField.Name]"
                        [selectFirstCountry]="false" [selectedCountryISO]="countryISO.UnitedStates"
                        [phoneValidation]="true" [separateDialCode]="true" [(ngModel)]="item.controlValue"
                        name="item.name">
                      </ngx-intl-tel-input>
                      <p class="vaiidate-field" *ngIf="item.showError">
                        Required field cannot be blank
                      </p>
                      <!-- <input type="text" (change)="updateValue(i, $event, item.type)" class="form-control" id="{{item.name}}" placeholder="{{item.placeholder}}"> -->
                    </div>
                    <div *ngIf="item.type=='number'">
                      <label class="private-form__label">{{item.label}}</label> <label *ngIf="item.required"
                        class="text-danger">*</label>
                      <small id="UIFormControl-632-help" tabindex="-1"
                        class="private-microcopy private-form__inlinehelp is--text--help">
                        {{item.description}}
                      </small>
                      <input type="number" (change)="updateValue(i, $event, item.type)" class="form-control"
                        id="{{item.name}}" min="{{item.min}}" [attr.value]="item.controlValue" max="{{item.max}}"
                        placeholder="{{item.placeholder}}">
                      <p class="vaiidate-field" *ngIf="item.showError">
                        Required field cannot be blank
                      </p>
                    </div>
                    <div *ngIf="item.type=='date'" class="customPlabookCalender calendar-paybook">
                      <label class="private-form__label">{{item.label}}</label> <label *ngIf="item.required"
                        class="text-danger">*</label>
                      <small id="UIFormControl-632-help" tabindex="-1"
                        class="private-microcopy private-form__inlinehelp is--text--help">
                        {{item.description}}
                      </small>
                      <p-calendar name="dateRange" selectionMode="single" [numberOfMonths]="1"
                        (onSelect)="onDateSelect('dateRange')" #dateRangeRef [readonlyInput]="true"
                        styleClass="p-calendar" [locale]="en" [defaultDate]="item.controlValue"
                        [(ngModel)]="item.controlValue" appendTo="body" [showIcon]="true">
                      </p-calendar>
                      <p class="vaiidate-field" *ngIf="item.showError">
                        Required field cannot be blank
                      </p>
                      <!-- <input type="date" (change)="updateValue(i, $event, item.type)" class="form-control" id="{{item.name}}" placeholder="{{item.placeholder}}"> -->
                    </div>
                    <div *ngIf="item.type=='datetime-local'">
                      <label class="private-form__label">{{item.label}}</label> <label *ngIf="item.required"
                        class="text-danger">*</label>
                      <small id="UIFormControl-632-help" tabindex="-1"
                        class="private-microcopy private-form__inlinehelp is--text--help">
                        {{item.description}}
                      </small>
                      <input type="datetime-local" (change)="updateValue(i, $event, item.type)" class="form-control"
                        [attr.value]="item.controlValue" id="{{item.name}}" placeholder="{{item.placeholder}}">
                      <p class="vaiidate-field" *ngIf="item.showError">
                        Required field cannot be blank
                      </p>
                    </div>
                    <div *ngIf="item.type=='textarea'">
                      <label class="private-form__label">{{item.label}}</label> <label *ngIf="item.required"
                        class="text-danger">*</label>
                      <small id="UIFormControl-632-help" tabindex="-1"
                        class="private-microcopy private-form__inlinehelp is--text--help">
                        {{item.description}}
                      </small>
                      <textarea rows="1" cols="50" (change)="updateValue(i, $event, item.type)" class="form-control"
                        id="{{item.name}}" [attr.value]="item.controlValue"
                        placeholder="{{item.placeholder}}"> </textarea>
                      <!-- <textarea class="txtarea" (change)="updateValue(i, $event, item.type)"  rows="3" name="Text" id="{{item.name}}" value=""> </textarea> -->
                      <p class="vaiidate-field" *ngIf="item.showError">
                        Required field cannot be blank
                      </p>
                    </div>
                    <div *ngIf="item.type=='file'">
                      <div class="custom-file-upload">
                        <input type="file" name="file" (change)="onFileSelectAgentForm($event, item.type, i)"
                          #fileUpload>
                        <div class="upload-area">
                          <svg height="15" viewBox="0 0 10.056 10" width="15">
                            <path class="a"
                              d="M9.389,26.25H.639A.591.591,0,0,1,0,25.639v-2.5A.6.6,0,0,1,.639,22.5a.6.6,0,0,1,.639.639v1.889h7.5V23.139a.639.639,0,1,1,1.278,0v2.5A.665.665,0,0,1,9.389,26.25Z"
                              transform="translate(0 -16.25)"></path>
                            <path class="a"
                              d="M12.7,2.694,10.2.194c-.083-.083-.139-.083-.194-.139a.59.59,0,0,0-.5,0c-.083,0-.139.083-.194.139l-2.5,2.5a.629.629,0,1,0,.889.889L9.146,2.139V6.278a.639.639,0,0,0,1.278,0V2.167l1.444,1.444a.588.588,0,0,0,.861,0A.631.631,0,0,0,12.7,2.694Z"
                              transform="translate(-4.785)"></path>
                          </svg>
                          <p>{{item.label}}</p><label *ngIf="item.required" class="text-danger">*</label>
                          <small id="UIFormControl-632-help" tabindex="-1"
                            class="private-microcopy private-form__inlinehelp is--text--help">
                            {{item.description}}
                          </small>
                        </div>
                      </div>
                      <p class="vaiidate-field" *ngIf="item.showError">
                        Required field cannot be blank
                      </p>
                    </div>
                    <div *ngIf="item.type=='paragraph'">
                      <p class="form-text">{{item.placeholder}}</p>
                      <small id="UIFormControl-632-help" tabindex="-1"
                        class="private-microcopy private-form__inlinehelp is--text--help">
                        {{item.label}}
                      </small>
                    </div>
                    <div *ngIf="item.type=='autocomplete'">
                      <label class="private-form__label" l>{{item.label}}</label> <label *ngIf="item.required"
                        class="text-danger">*</label>
                      <small id="UIFormControl-632-help" tabindex="-1"
                        class="private-microcopy private-form__inlinehelp is--text--help">
                        {{item.description}}
                      </small>
                      <p-dropdown class="select-dropdown form-control setDropPadding"
                        (onChange)="updateValue(i, $event, item.type)" [(ngModel)]="item.controlValue"
                        [options]="item.values" placeholder="{{item.label}}" appendTo="body" name="{{item.name}}">
                      </p-dropdown>
                      <p class="vaiidate-field" *ngIf="item.showError">
                        Required field cannot be blank
                      </p>
                    </div>
                    <div class="play-book-checkbox" *ngIf="item.type=='checkbox'">
                      <label class="private-form__label">{{item.label}}</label> <label *ngIf="item.required"
                        class="text-danger">*</label>
                      <small id="UIFormControl-632-help" tabindex="-1"
                        class="private-microcopy private-form__inlinehelp is--text--help">
                        {{item.description}}
                      </small>
                      <div style="height: 176px;overflow-y: auto;align-items: flex-start;">
                        <div *ngFor="let v of item.values" class="inline-form-group">
                          <label class="custom-checkbox label-wrapper-box">
                            {{v.label}}
                            <p-checkbox styleClass="custom-checkbox label-play-check" binary="true"
                              [(ngModel)]="v.checked" name="{{item.name}}"
                              (onChange)="updateValue(i, v.value, item.type)">
                            </p-checkbox>
                            <!-- <input type="checkbox" (change)="updateValue(i, v.value, item.type)" [checked]="v.checked"
                          [value]="v.value" name="{{item.name}}" (click)="toggleValue(v)"> -->
                            <span></span>
                          </label>
                        </div>
                      </div>
                      <p class="vaiidate-field" *ngIf="item.showError">
                        Required field cannot be blank
                      </p>
                    </div>
                    <div *ngIf="item.type=='radio'" class="genderComponent">
                      <label class="private-form__label">{{item.label}}</label> <label *ngIf="item.required"
                        class="text-danger">*</label>
                      <small id="UIFormControl-632-help" tabindex="-1"
                        class="private-microcopy private-form__inlinehelp is--text--help">
                        {{item.description}}
                      </small>
                      <div class="row" style="max-height: 171px;overflow-y: auto;align-items: flex-start;">
                        <div *ngFor="let v of item.values" class="col-md-12">
                          <label class="custom-radio" for="{{v.label}}">
                            {{v.label}}
                            <input id="{{v.label}}" (change)="updateValue(i, v.value, item.type)" name="{{item.name}}"
                              [checked]="v.checked" type="radio" [value]="v.value">
                            <span></span>
                          </label>
                        </div>
                      </div>
                      <p class="vaiidate-field" *ngIf="item.showError">
                        Required field cannot be blank
                      </p>
                    </div>
                    <div *ngIf="item.type=='button'" class="btn-cont">
                      <small id="UIFormControl-632-help" tabindex="-1"
                        class="private-microcopy private-form__inlinehelp is--text--help">
                        {{item.description}}
                      </small>
                      <input type="{{item.subtype}}" (click)="submit()" value="{{item.label}}" class="btn btn-primary"
                        id="{{item.name}}">
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </form>
        <p-footer class="btns">
          <ion-button [disabled]="false" (click)="submitPlaybookForm(model.addition)" class="btn-save">Save
          </ion-button>
          <ion-button class="btn-cancel" (click)="PlaybookFormPopup = false">Cancel</ion-button>
        </p-footer>
      </p-dialog>

      <p-dialog position="center" [draggable]="false" [visible]="assignTo"
        class="popup-element custom-popup add-contact add-contact-wrapper" [modal]="true">
        <p-header>Assign To
          <span class="close-pop" (click)="assignTo = false;  user = ''"><img src="assets/images/close.svg"
              alt="close" /></span>
        </p-header>
        <form>
          <div class="col-12 pt-3 pl-0 pr-0">
            <div class="vaildation-area dropdown-top">
              <p-dropdown class="select-dropdown" [options]="userData" placeholder="Select" appendTo="body" name="user"
                [(ngModel)]="user">
              </p-dropdown>
            </div>
          </div>
        </form>

        <p-footer class="btns">
          <ion-button class="btn-save" (click)="updateUser()" [disabled]="user === undefined || user === ''">Save
          </ion-button>
          <ion-button class="btn-cancel" (click)="assignTo = false; user = ''">Cancel</ion-button>
        </p-footer>
      </p-dialog>